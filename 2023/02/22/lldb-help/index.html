<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> lldb 命令简介 · VictorV的小博客</title><meta name="description" content="lldb 命令简介 - VictorV"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://474172261.github.io/atom.xml" title="VictorV的小博客"><meta name="generator" content="Hexo 6.2.0"><link rel="alternate" href="/atom.xml" title="VictorV的小博客" type="application/atom+xml">
</head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/images/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://twitter.com/vv474172261" target="_blank" class="nav-list-link">TWITTER</a></li><li class="nav-list-item"><a href="https://github.com/474172261" target="_blank" class="nav-list-link">GITHUB</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">lldb 命令简介</h1><div class="post-info">2023年2月22日</div><div class="post-content"><span id="more"></span>

<h1 id="查看模块基址"><a href="#查看模块基址" class="headerlink" title="查看模块基址"></a>查看模块基址</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(lldb) image list |grep prl_vm_app</span><br><span class="line">[  0] 08F2E3D7-D9F0-38E9-BA1F-0CA1E42095DE 0x000000010ca07000 /Applications/Parallels Desktop.app/Contents/MacOS/Parallels VM.app/Contents/MacOS/prl_vm_app</span><br></pre></td></tr></table></figure>

<h1 id="搜索符号位置"><a href="#搜索符号位置" class="headerlink" title="搜索符号位置"></a>搜索符号位置</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) image lookup -n funcname</span><br></pre></td></tr></table></figure>



<h1 id="下断点"><a href="#下断点" class="headerlink" title="下断点"></a>下断点</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">br set -a 0xXXXXXXXX 对地址下断点</span><br><span class="line">br set -f filename -l line</span><br><span class="line">br set -n viewDidLoad</span><br><span class="line">br set -n &quot;[类名 方法名]&quot;</span><br><span class="line">br list 列出断点</span><br><span class="line">br disa 禁用所有</span><br><span class="line">br en 3 启用断点3</span><br></pre></td></tr></table></figure>

<p>如果需要添加条件, 在最后添加<code>-c &quot;width &gt; 68&quot;</code>, 条件为width &gt; 68.</p>
<h2 id="断点命令"><a href="#断点命令" class="headerlink" title="断点命令"></a>断点命令</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(lldb) br com add 1</span><br><span class="line">Enter your debugger command(s).  Type &#x27;DONE&#x27; to end.</span><br><span class="line">&gt; p i</span><br><span class="line">&gt; bt</span><br><span class="line">&gt; DONE</span><br></pre></td></tr></table></figure>

<h1 id="条件断点"><a href="#条件断点" class="headerlink" title="条件断点"></a>条件断点</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">w s e -- 0x123456</span><br><span class="line">w s e -s 2 -- 0x123456</span><br><span class="line">w s e -w read/write -s 2 -- 0x123456</span><br></pre></td></tr></table></figure>

<h1 id="查看寄存器"><a href="#查看寄存器" class="headerlink" title="查看寄存器"></a>查看寄存器</h1><p><code>reg read</code>, <code>reg read rax</code></p>
<h1 id="反汇编"><a href="#反汇编" class="headerlink" title="反汇编"></a>反汇编</h1><p>显示指定地址的汇编</p>
<p><code>(lldb) dis -s $pc</code></p>
<p>也可以用<code>x/i</code></p>
<p>通过<code>(lldb) help arch</code>获取支持的架构, 然后<code>(lldb) dis -A arm -s $pc</code></p>
<h1 id="单步"><a href="#单步" class="headerlink" title="单步"></a>单步</h1><p>si, ni, fin等</p>
<h1 id="设置变量"><a href="#设置变量" class="headerlink" title="设置变量"></a>设置变量</h1><p><code>expr long $test = 12</code></p>
<p><code>p $test=123</code></p>
<h1 id="读取和修改内存"><a href="#读取和修改内存" class="headerlink" title="读取和修改内存"></a>读取和修改内存</h1><p><code>x/10gx addr</code>, ‘c, b, w, d, g’</p>
<p><code>memory write -s 2 &#39;bytes&#39; 1 2 3 4</code></p>
<h1 id="自定义命令"><a href="#自定义命令" class="headerlink" title="自定义命令"></a>自定义命令</h1><p>1.别名(alias),使用简单,但是这个只能用来实现没有输入的命令<br> 2.正则命令(command regex),可以通过正则表达式来捕获输入,并且将其应用到命令中.但是这个在执行多行命令的时候非常不方便,并且,这个只能有一个输入参数.<br> 3.桥接脚本(script bridging) 基于python,这个很好的权衡了方便和复杂性.并且可以做任何LLDB能做的事情.</p>
<p>针对第三种:</p>
<p>在命令行直接运行:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">script import sys</span><br><span class="line">script print (sys.version)</span><br></pre></td></tr></table></figure>

<p>在文件test.py中创建:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">def findclass(debugger,command,result,internal_dict):</span><br><span class="line">    print(&quot;hello lldb&quot;)</span><br><span class="line">    # command 为输入</span><br><span class="line"></span><br><span class="line">def __lldb_init_module(debugger, internal_dict):</span><br><span class="line">    debugger.HandleCommand(&#x27;command script add -f findclass.findclass testcmd&#x27;)</span><br></pre></td></tr></table></figure>

<p>然后在lldb中引用<code>command script import ~/test.py</code></p>
<h1 id="调试"><a href="#调试" class="headerlink" title="调试"></a>调试</h1><p>参考<a target="_blank" rel="noopener" href="https://lldb.llvm.org/use/remote.html">Remote Debugging</a></p>
<h2 id="远程调试"><a href="#远程调试" class="headerlink" title="远程调试"></a>远程调试</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">./lldb-server platform --listen <span class="string">&quot;*:1234&quot;</span> --server</span><br><span class="line"></span><br><span class="line">进入lldb client端</span><br><span class="line">(lldb) platform status <span class="comment"># 查看平台状态</span></span><br><span class="line">(lldb) platform list</span><br><span class="line">(lldb) platform select remote-freebsd</span><br><span class="line">  Platform: remote-freebsd</span><br><span class="line"> Connected: no</span><br><span class="line">(lldb) platform connect connect://192.168.1.8:1234</span><br><span class="line">  Platform: remote-freebsd</span><br><span class="line">    Triple: arm-unknown-linux-unknown</span><br><span class="line">OS Version: 5.10.93 (5.10.93)</span><br><span class="line">  Hostname: localhost</span><br><span class="line"> Connected: <span class="built_in">yes</span></span><br><span class="line">WorkingDir: /</span><br><span class="line">    Kernel: <span class="comment">#1 SMP Wed Dec 7 15:20:41 CST 2022</span></span><br><span class="line">(lldb)</span><br></pre></td></tr></table></figure>

<h2 id="更改workingdir"><a href="#更改workingdir" class="headerlink" title="更改workingdir"></a>更改workingdir</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(lldb) platform settings -w /usr/local/bin</span><br></pre></td></tr></table></figure>

<h2 id="将本地文件推送到目的机器运行"><a href="#将本地文件推送到目的机器运行" class="headerlink" title="将本地文件推送到目的机器运行"></a>将本地文件推送到目的机器运行</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(lldb) file a.out</span><br><span class="line">(lldb) run</span><br></pre></td></tr></table></figure>

<h2 id="attach"><a href="#attach" class="headerlink" title="attach"></a>attach</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">file  [target_binary] # 指定将要调试的二进制文件,注意是相对于WorkingDir的路径</span><br><span class="line">platform process list # 查看一直远端的进程, 找到目标进程pid, 或者名称</span><br><span class="line">attach 9053</span><br></pre></td></tr></table></figure>

<h2 id="将本地文件推到目的机器指定目录"><a href="#将本地文件推到目的机器指定目录" class="headerlink" title="将本地文件推到目的机器指定目录"></a>将本地文件推到目的机器指定目录</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(lldb) file a.out</span><br><span class="line">(lldb) script lldb.target.module[&#x27;a.out&#x27;].SetPlatformFileSpec(&quot;/bin/a.out&quot;)</span><br><span class="line"># 如果要包含模块</span><br><span class="line">(lldb) target module add /local/build/libfoo.so # 本地地址</span><br><span class="line">(lldb) script lldb.target.module[&#x27;libfoo.so&#x27;].SetPlatformFileSpec(&quot;/usr/lib/libfoo.so&quot;)</span><br></pre></td></tr></table></figure>

</div></article></div></main><footer><div class="paginator"><a href="/2023/02/22/linux-skill/" class="prev">上一篇</a><a href="/2023/02/22/linux-debug-setting/" class="next">下一篇</a></div><div id="container"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css"><script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script><div id="gitalk-container"></div><script>const gitalk = new Gitalk({
    clientID: '28b1a73c3ed656a9a85d',     
    clientSecret: '59837bb4cbe7b2f12df366fdbcb37fa4ba084d44',     
    id: 'Wed Feb 22 2023 19:54:44 GMT+0800',    
    repo: 'blog-comment',     
    owner: '474172261',     
    admin: '474172261',     
})   
gitalk.render('gitalk-container')</script><div class="copyright"><p>© 2015 - 2025 <a href="http://474172261.github.io">VictorV</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>